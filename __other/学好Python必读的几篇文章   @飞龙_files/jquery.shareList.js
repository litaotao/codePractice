var ShareJquery=jQuery;(function(b){b.fn.shareList=function(c){var d;var e="shareList";if(typeof c=="string"){if(c=="api"){return b(this).data(e).interfaces[b(this).data(e).current]}else{if(c=="interfaces"){return b(this).data(e).interfaces}}}else{var c=c||{};d=b.extend(true,{},b.fn.shareList.defaults,c);if(c.shareSites){d.shareSites=c.shareSites}}return b(this).each(function(){if(typeof c=="string"){}else{var f=new a.ShareList(d);f.$applyTo=b(this);f.render();b(this).data(e,f)}})};var a=a||{};a.ShareList=function(c){this.options=b.extend(b.fn.shareList.defaults,c);this.effect=this.options.effect;this.$applyTo=c.applyTo&&b(c.applyTo)||null;this.$li=null;this.width=0;this.liWidth=0;this.tpl=this.options.tpl;this.getListAjaxOptions=this.options.getListAjaxOptions;this.pageUrl=encodeURIComponent(window.location.href);this.pageTitle=encodeURIComponent(document.title.substring(0,76));if(b.browser.msie&&(b.browser.version=="6.0")&&!b.support.style){this.options.showShadow=false}};a.ShareList.prototype={render:function(){var d=this,c=this.options.cls,e="";if(this.$applyTo!=null&&this.$applyTo.size()>0){if(d.options.smallIcon){e="share-small-icon"}this.$applyTo.html("<div class='"+c.shareList+" "+e+"'></div>");this.$applyTo.css({position:"relative",overflow:"hidden"});this.options.style&&this.$applyTo.css(this.options.style);this.$applyTo=this.$applyTo.children("."+c.shareList);b.ajax({url:this.getListAjaxOptions.url,type:this.getListAjaxOptions.type,dataType:this.getListAjaxOptions.dataType,success:function(f){d._getListSuccess(f)},beforeSend:function(){d._getListBeforeSend()}})}},_getListSuccess:function(e){var d=this;var c=this.options.cls;d._createList(e,function(){d.$li=d.$applyTo.children();d.options.showShadow&&d.$li.children("."+c.text).hide();d._setLocalBookmark();d._addShadow();d._setUlWidth();d.options.follow&&d._followMouseScroll();d.$li.hover(function(){var f=b(this).index();d.iconToTop(f)},function(){var f=b(this).index();d.iconTopDefault(f)});d.getListAjaxOptions.success&&d.getListAjaxOptions.success.call(this,e)})},_getListBeforeSend:function(){this.$applyTo.html("<img src='"+this.options.preloadImgSrc+"' class='"+this.options.cls.preload+"' />");this.getListAjaxOptions.beforeSend&&this.getListAjaxOptions.beforeSend.call(this,data)},_createList:function(g,f){var c=this;var e;var d=c.options.shareSites;var h=[];b.each(d,function(i){b.each(g,function(j){if(g[j].name==d[i]){e=c.tpl.TFtpl(g[j]);e=e.TFtpl({url:c.pageUrl,title:c.pageTitle});h.push(e);return true}})});c.$applyTo.children().fadeOut("slow",function(){c.$applyTo.html(h.join(""));f&&f.call(this)})},_setLocalBookmark:function(){var c=this;this.$li.children("."+this.options.cls.icon+"[name=favorite]").click(function(){d(window.location.href,document.title.substring(0,76));return false}).next().click(function(){return false});function d(e,f){if(window.sidebar){window.sidebar.addPanel(f,e,"")}else{if(document.all){window.external.AddFavorite(e,f)}else{if(window.opera&&window.print){return true}}}}},_addShadow:function(){var c=this.options,d;if(c.showShadow){d=c.smallIcon&&c.smallShadowSrc||c.shadowSrc;b("<div class='"+c.cls.iconShadow+"'><img src='"+d+"' /></div>").appendTo(this.$li)}},_setUlWidth:function(){var c=this.$li.eq(0);this.liWidth=c.width()+parseInt(c.css("marginLeft"))+parseInt(c.css("marginRight"));this.$applyTo.width(this.liWidth*this.$li.size());this.width=this.$applyTo.width()},_followMouseScroll:function(){var e=this;var d=this.options;var c=this.$applyTo.parent().width();var f=this.width-c;if(this.width>c){this.$applyTo.mousemove(function(i){if(d.allowSroll){var h=i.pageX;var g=e.$applyTo.offset();e.$applyTo.css({marginLeft:"-"+f*(Math.max(h-g.left,0)/e.width)+"px"})}});this.$applyTo.mouseleave(function(j){if(!jQuery.browser.msie||jQuery.browser.version!="7.0"){var i=Math.abs(Math.floor(parseInt(e.$applyTo.css("marginLeft"))));var g=i%e.liWidth;if(g!=0){var h=Math.floor(i/e.liWidth);e.$applyTo.animate({marginLeft:"-"+h*e.liWidth},"fast")}}})}},iconToTop:function(e){var g=this;var j=g.effect.liHover;var d=this.options.speed;var h=this.$li.eq(e);var c=this.options.cls.icon;var i=this.options.smallIcon&&j.smallShadowImg||j.shadowImg;if(h.size()>0){h.children("."+c).stop().animate(j.icon,d,function(){b(this).animate(j.iconBack,d)});if(this.options.showShadow){var f=h.children("."+this.options.cls.iconShadow);f.children("img").css("display","block");f.children("img").stop().animate(i,d);f.stop().animate(j.shadowDiv,d)}}},iconTopDefault:function(f){var h=this;var c=h.effect.liMouseout;var e=this.options.speed;var i=this.$li.eq(f);var d=this.options.cls.icon;var j=this.options.smallIcon&&c.smallShadowImg||c.shadowImg;if(i.size()>0){i.children("."+d).stop().animate(c.icon,e,function(){b(this).animate(c.iconBack,e)});if(this.options.showShadow){var g=i.children("."+this.options.cls.iconShadow);g.children("img").stop().animate(j,e);g.stop().animate(c.shadowDiv,e)}}}};b.fn.shareList.interfaces=[];b.fn.shareList.classes={defaults:{shareList:"share-list",shareListLi:"share-list-item",icon:"share-list-icon",text:"share-list-text",iconShadow:"share-list-icon-shadow",preload:"share-list-preload"}};b.fn.shareList.tpl={defaults:'<div class="share-list-item"><a href="{href}" name="{name}" localName="{localName}" class="share-list-icon icon-{name}" target="_blank"></a><a href="{href}" class="share-list-text">{localName}</a></div> '};b.fn.shareList.defaults={shareSites:["9dian","feerbook","chouti","diglog","sinaminiblog","renren","zhuaxia","xianguo","greader","qqshuqian","douban","twitter","favorite","kaixin001","baiducang","gbuzz","digu","zuosa","renjian","sohubai"],getListAjaxOptions:{type:"GET",url:"js/shareListData.js",dataType:"json"},smallIcon:false,allowSroll:true,showShadow:true,follow:true,shadowSrc:"style/images/icon-shadow.png",smallShadowSrc:"style/images/icon-shadow-small.png",preloadImgSrc:"style/images/loading.gif",speed:250,style:null,effect:{liHover:{icon:{marginTop:"-6px"},iconBack:{marginTop:"-6px"},shadowImg:{width:"65%",height:"10px",marginLeft:"10px"},smallShadowImg:{width:"65%",height:"10px",marginLeft:"8px"},shadowDiv:{opacity:0.25}},liMouseout:{icon:{marginTop:"4px"},iconBack:{marginTop:"0px"},shadowImg:{width:"100%",height:"21px",marginLeft:"0"},smallShadowImg:{width:"100%",height:"15px",marginLeft:"0"},shadowDiv:{opacity:1}}},cls:b.fn.shareList.classes.defaults,tpl:b.fn.shareList.tpl.defaults}})(jQuery);String.prototype.TFtpl=function(a){return this.replace(/{([^{}]*)}/g,function(d,c){var e=a[c];return typeof e==="string"?e:d})};
